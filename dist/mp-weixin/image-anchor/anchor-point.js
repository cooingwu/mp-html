"use strict";function t(t,i){var a=e[t];if(!a)return"";var l=encodeURIComponent(i||"#ffffff");return a.replace(/\{\{COLOR\}\}/g,l)}var e={"info-circle":"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='{{COLOR}}'%3E%3Cpath d='M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z'/%3E%3C/svg%3E","question-circle":"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='{{COLOR}}'%3E%3Cpath d='M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25z'/%3E%3C/svg%3E","exclamation-circle":"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='{{COLOR}}'%3E%3Cpath d='M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z'/%3E%3C/svg%3E",star:"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='{{COLOR}}'%3E%3Cpath d='M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z'/%3E%3C/svg%3E",heart:"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='{{COLOR}}'%3E%3Cpath d='M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z'/%3E%3C/svg%3E","thumb-up":"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='{{COLOR}}'%3E%3Cpath d='M1 21h4V9H1v12zm22-11c0-1.1-.9-2-2-2h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 1 7.59 7.59C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73v-2z'/%3E%3C/svg%3E",location:"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='{{COLOR}}'%3E%3Cpath d='M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z'/%3E%3C/svg%3E",eye:"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='{{COLOR}}'%3E%3Cpath d='M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z'/%3E%3C/svg%3E"};Component({properties:{anchor:{type:Object,value:{}},styles:{type:Array,value:[]},animation:{type:Boolean,value:!0},imageWidth:{type:Number,value:0},imageHeight:{type:Number,value:0}},data:{size:32,styleType:"default",styleImage:"",shapeStyle:"",shapeClass:"",iconSvg:"",iconColor:"#ffffff",labelPosition:"right",isPC:!1,pulseColor:"#ff4d4f"},observers:{"anchor, styles, imageWidth":function(t,e,i){t&&i&&this.updateStyle()}},lifetimes:{attached:function(){try{var t=wx.getSystemInfoSync();this.setData({isPC:"windows"===t.platform||"mac"===t.platform})}catch(t){console.error("获取系统信息失败",t)}}},methods:{updateStyle:function(){var e,i,a=this,l=this.data,o=l.anchor,s=l.styles,n=l.imageWidth,r=l.isPC;if(o&&o.style){var c=n*(o.style.size||8)/100;r&&c<24&&(c=24),!r&&c<20&&(c=20);var h=o.style.presetId?s.find(function(t){return t._id===o.style.presetId}):null,g="default",v="",f="",d="",m="",p="#ffffff";if(h)if(g=h.type||"shape","image"===h.type&&h.image)v=h.image;else if("shape"===h.type&&h.shape){var u=h.shape;d="shape-"+(u.type||"circle");var C=[];u.color&&C.push("background-color: ".concat(u.color)),u.borderWidth&&u.borderColor&&C.push("border: ".concat(u.borderWidth,"px solid ").concat(u.borderColor)),f=C.join(";"),u.color||"#ff4d4f"}else"icon"===h.type&&h.icon&&(p=h.icon.color||"#ffffff",m=t(h.icon.name,p),p);else o.style.customImage?(g="image",v=o.style.customImage):(g="default",o.style.color||"#ff4d4f");this.setData({size:c,styleType:g,styleImage:v,shapeStyle:f,shapeClass:d,iconSvg:m,iconColor:p,labelPosition:(null===(e=o.label)||void 0===e?void 0:e.position)||"right"}),null!==(i=o.label)&&void 0!==i&&i.text&&setTimeout(function(){a.calculateAndUpdateLabelPosition()},50)}},calculateAndUpdateLabelPosition:function(){var t,e=this,i=this.data,a=i.anchor,l=i.imageWidth,o=i.imageHeight;if(null!==a&&void 0!==a&&null!==(t=a.label)&&void 0!==t&&t.text){var s=a.label.position||"right";if(!(!1!==a.label.autoPosition))return void this.setData({labelPosition:s});var n=this.createSelectorQuery();n.select(".anchor-label").boundingClientRect(),n.exec(function(t){var i=t[0];if(!i)return void e.setData({labelPosition:s});var n=a.position||{x:50,y:50},r=n.x,c=n.y,h=o||.75*l,g=i.width/l*100+3,v=i.height/h*100+3,f={right:100-r>g,left:r>g,top:c>v,bottom:100-c>v},d=[s,"right","left","top","bottom"].filter(function(t,e,i){return i.indexOf(t)===e}),m=d.find(function(t){return f[t]})||"hidden";console.log("[anchor-point] Label 位置计算:",{labelSize:{width:i.width,height:i.height},imageSize:{width:l,height:h},anchorPosition:{x:r,y:c},spaceMap:f,result:m}),e.setData({labelPosition:m})})}},calculateLabelPosition:function(t){return t.label&&t.label.text?t.label.position||"right":"right"},onTap:function(){this.triggerEvent("anchortap",{anchor:this.data.anchor})}}});