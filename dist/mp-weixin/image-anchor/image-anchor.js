"use strict";function t(e){"@babel/helpers - typeof";return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),o.push.apply(o,r)}return o}function o(t){for(var o=1;o<arguments.length;o++){var n=null!=arguments[o]?arguments[o]:{};o%2?e(Object(n),!0).forEach(function(e){r(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):e(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function r(t,e,o){return(e=n(e))in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function n(e){var o=i(e,"string");return"symbol"==t(o)?o:o+""}function i(e,o){if("object"!=t(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,o||"default");if("object"!=t(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===o?String:Number)(e)}Component({options:{addGlobalClass:!0},properties:{node:{type:Object,value:{}},opts:{type:Array,value:[]}},data:{imageLoaded:!1,imageWidth:0,imageHeight:0,anchors:[],styles:[],mode:"container",animation:!0,activeAnchor:null,tooltipPosition:"bottom",showModal:!1},lifetimes:{attached:function(){this.initFromRoot()}},methods:{initFromRoot:function(){for(var t=null,e=this.selectOwnerComponent();e;){if(e.data&&void 0!==e.data.imageAnchors){t=e;break}e=e.selectOwnerComponent?e.selectOwnerComponent():null}t||this.root&&(t=this.root);var o=this.data.node,r=[];if(o.anchorData&&o.anchorData.anchors)r=o.anchorData.anchors;else if(t){var n=parseInt(o.attrs&&o.attrs["data-image-index"])||0,i=t.data.imageAnchors||[];r=i.filter(function(t){return t.imageIndex===n})}var a=t?t.data.anchorStyles||[]:[],s=t?t.data.tooltipMode||"container":"container",c=!t||!1!==t.data.showAnchorAnimation;this.setData({anchors:r,styles:a,mode:s,animation:c}),t&&(this.root=t)},onImageLoad:function(t){var e=this,o=t.detail;o.width,o.height;this.createSelectorQuery().select(".anchor-image").boundingClientRect(function(t){t&&e.setData({imageLoaded:!0,imageWidth:t.width,imageHeight:t.height})}).exec(),this.triggerEvent("imgload",t.detail)},onImageError:function(t){this.triggerEvent("imgerror",t.detail)},onImageTap:function(t){if(!(t.target&&t.target.dataset&&t.target.dataset.anchor)){var e=this.data.node;this.triggerEvent("imgtap",e.attrs)}},onAnchorTap:function(t){var e=t.detail||{},o=e.anchor;if(o){var r=this.data.mode,n=o.position||{x:50,y:50},i=n.y>60?"top":"bottom";this.setData({activeAnchor:o,tooltipPosition:i,showModal:"modal"===r}),this.triggerEvent("anchortap",{anchor:o}),this.triggerEvent("tooltipshow",{anchor:o})}},onTooltipClose:function(){var t=this.data.activeAnchor;this.setData({activeAnchor:null,showModal:!1}),this.triggerEvent("tooltiphide",{anchor:t})},onPageChange:function(t){this.triggerEvent("pagechange",o(o({},t.detail),{},{anchor:this.data.activeAnchor}))},onMaskTap:function(){this.onTooltipClose()},stopPropagation:function(){}}});